# 滑动窗口

```c++
class Solution {
public:
    vector<int> findAnagrams(string s, string p) {
        map<char, int> target;
        map<char, int> window;
        for (int i = 0; i < p.size(); i++) {
            target[p[i]] += 1;
            window[p[i]] = 0;
        }

        int l = 0, r = 0, valid = 0;
        vector<int> ans;

        while (r < s.size()) {
            char c1 = s[r];
            r += 1;

            if (target.count(c1) > 0) {
                window[c1] += 1;
                if (window[c1] == target[c1]) {
                    valid += 1;
                }
            }

            while (r - l == p.size()) { // 收缩窗口
                if (valid == target.size()) { // 更新答案
                    ans.push_back(l);
                }
                char c2 = s[l];
                l += 1;
                if (target.count(c2) > 0) {
                    if (window[c2] == target[c2]) {
                        valid -= 1;
                    }
                    window[c2] -= 1;
                }
            }
        }
        return ans;
    }
};
```

```c#
public class Solution {
    public IList<int> FindAnagrams(string s, string p) {
        Dictionary<char, int> target = new Dictionary<char, int>();
        Dictionary<char, int> window = new Dictionary<char, int>();

        for (int i = 0; i < p.Length; i++) {
            if (target.ContainsKey(p[i])) {
                target[p[i]] += 1;
            } else {
                target[p[i]] = 1;
            }

            if (!window.ContainsKey(p[i])) {
                window.Add(p[i], 0);
            }
        }

        IList<int> ans = new List<int>();
        int l = 0, r = 0, valid = 0;

        while (r < s.Length) {
            char c1 = s[r];
            r += 1;

            if (target.ContainsKey(c1)) {
                window[c1] += 1;
                if (window[c1] == target[c1]) {
                    valid += 1;
                }
            }

            while (r-l == p.Length) {
                if (valid == target.Count) {
                    ans.Add(l);
                }
                char c2 = s[l];
                l += 1;
                if (target.ContainsKey(c2)) {
                    if (window[c2] == target[c2]) {
                        valid -= 1;
                    }
                    window[c2] -= 1;
                }
            }
        }
        return ans;
    }
}
```

